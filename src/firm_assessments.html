<!DOCTYPE html>
<html lang="en">
<head>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* Hide body by default to prevent content flashing */
        body { opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
    </style>
    <script>
        // 1. Config
        const GATEKEEPER_URL = 'https://mpxayhidmnzykuibpfin.supabase.co';
        const GATEKEEPER_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1weGF5aGlkbW56eWt1aWJwZmluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5MTg4NDIsImV4cCI6MjA4MjQ5NDg0Mn0.LbOySRbVBvH5UpHWMbO938p5tVUdGtAYnSMsW3Vi2e8';
        const supabaseGatekeeper = window.supabase.createClient(GATEKEEPER_URL, GATEKEEPER_KEY);

        // 2. Auth Check (The "Hard Check")
        async function checkAuth() {
            try {
                // getUser() contacts the server to verify the user still exists
                const { data: { user }, error } = await supabaseGatekeeper.auth.getUser();
                
                if (error || !user) {
                    // User is deleted or token is invalid -> FORCE LOGOUT
                    console.warn("User validation failed. Redirecting...");
                    await supabaseGatekeeper.auth.signOut(); // Clear local session
                    localStorage.clear(); // Nuke any leftovers
                    window.location.replace("../index.html"); 
                } else {
                    // Logged in & Valid -> Reveal Page
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', showPage);
                    } else {
                        showPage();
                    }
                }
            } catch (error) {
                console.error("Auth system error:", error);
                window.location.replace("../index.html");
            }
        }

        function showPage() {
            document.body.style.opacity = "1";
            document.body.style.pointerEvents = "auto";
        }

        checkAuth();
    </script>
    

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* Hide body by default to prevent content flashing */
        body { opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
    </style>
    <script>
        // 1. Config
        const GATEKEEPER_URL = 'https://mpxayhidmnzykuibpfin.supabase.co';
        const GATEKEEPER_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1weGF5aGlkbW56eWt1aWJwZmluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5MTg4NDIsImV4cCI6MjA4MjQ5NDg0Mn0.LbOySRbVBvH5UpHWMbO938p5tVUdGtAYnSMsW3Vi2e8';
        
        // Use a unique variable name to avoid conflicts
        const supabaseGatekeeper = window.supabase.createClient(GATEKEEPER_URL, GATEKEEPER_KEY);

        // 2. Auth Check
        async function checkAuth() {
            try {
                const { data: { session } } = await supabaseGatekeeper.auth.getSession();
                
                if (!session) {
                    // Not logged in? Redirect to Main Hub
                    // Adjust this path if your files are in sub-sub-folders
                    window.location.replace("../index.html"); 
                } else {
                    // Logged in? Wait for body to exist, then reveal
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', showPage);
                    } else {
                        showPage();
                    }
                }
            } catch (error) {
                console.error("Auth check failed:", error);
                window.location.replace("../index.html"); // Fail safe
            }
        }

        function showPage() {
            document.body.style.opacity = "1";
            document.body.style.pointerEvents = "auto";
        }

        checkAuth();
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantQuest | Company Tracks</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono:wght@500;700&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #020617; }
        
        .firm-card { 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid rgba(255,255,255,0.05); 
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
        }
        .firm-card:hover { transform: translateY(-5px); }
        
        /* Specific Firm Themes for Hover */
        .theme-cyan:hover { border-color: rgba(6, 182, 212, 0.5); box-shadow: 0 20px 40px -10px rgba(6, 182, 212, 0.2); }
        .theme-blue:hover { border-color: rgba(59, 130, 246, 0.5); box-shadow: 0 20px 40px -10px rgba(59, 130, 246, 0.2); }
        .theme-red:hover { border-color: rgba(239, 68, 68, 0.5); box-shadow: 0 20px 40px -10px rgba(239, 68, 68, 0.2); }
        .theme-green:hover { border-color: rgba(34, 197, 94, 0.5); box-shadow: 0 20px 40px -10px rgba(34, 197, 94, 0.2); }
        .theme-orange:hover { border-color: rgba(249, 115, 22, 0.5); box-shadow: 0 20px 40px -10px rgba(249, 115, 22, 0.2); }
    </style>

    <link rel="manifest" href="../manifest.json">
    <meta name="theme-color" content="#020617">
    <link rel="apple-touch-icon" href="../icon-192.png">
    
</head>
<body class="text-slate-200 min-h-screen p-4 lg:p-10">

    <div class="max-w-7xl mx-auto animate-in fade-in duration-500">
        
        <header class="mb-12">
            <a href="../index.html" class="inline-flex items-center text-slate-500 hover:text-white text-xs font-bold uppercase tracking-widest mb-6 transition-colors">
                <i class="bi bi-arrow-left mr-2"></i> Back to Main Hub
            </a>
            <div class="flex justify-between items-end border-b border-white/10 pb-8">
                <div>
                    <h1 class="text-4xl lg:text-5xl font-extrabold text-white tracking-tight mb-2">COMPANY <span class="text-indigo-500">TRACKS</span></h1>
                    <p class="text-slate-500 font-bold uppercase tracking-[0.2em] text-xs">Targeted Preparation Modules</p>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

            <a href="mako_quiz.html" class="firm-card theme-blue p-8 rounded-[2rem] group block relative overflow-hidden">
                <div class="absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i class="bi bi-water text-9xl text-blue-500"></i>
                </div>
                <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center mb-6 border border-blue-500/30 text-blue-400">
                    <i class="bi bi-tsunami text-xl"></i>
                </div>
                <h3 class="text-2xl font-black text-white mb-1 group-hover:text-blue-400 transition-colors">Mako Trading</h3>
                <div class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-4">Options & Volatility</div>
                <div class="flex items-center text-xs font-bold text-blue-500 uppercase tracking-widest group-hover:translate-x-2 transition-transform">
                    Start Test <i class="bi bi-arrow-right ml-2"></i>
                </div>
            </a>

            <a href="davinci_quiz.html" class="firm-card theme-cyan p-8 rounded-[2rem] group block relative overflow-hidden">
                <div class="absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i class="bi bi-cpu text-9xl text-cyan-500"></i>
                </div>
                <div class="w-12 h-12 bg-cyan-500/20 rounded-xl flex items-center justify-center mb-6 border border-cyan-500/30 text-cyan-400">
                    <i class="bi bi-cpu text-xl"></i>
                </div>
                <h3 class="text-2xl font-black text-white mb-1 group-hover:text-cyan-400 transition-colors">Da Vinci Trading</h3>
                <div class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-4">Derivatives & Logic</div>
                <div class="flex items-center text-xs font-bold text-cyan-500 uppercase tracking-widest group-hover:translate-x-2 transition-transform">
                    Start Test <i class="bi bi-arrow-right ml-2"></i>
                </div>
            </a>

            <a href="maven_quiz.html" class="firm-card theme-red p-8 rounded-[2rem] group block relative overflow-hidden">
                <div class="absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i class="bi bi-bullseye text-9xl text-red-500"></i>
                </div>
                <div class="w-12 h-12 bg-red-500/20 rounded-xl flex items-center justify-center mb-6 border border-red-500/30 text-red-400">
                    <i class="bi bi-bullseye text-xl"></i>
                </div>
                <h3 class="text-2xl font-black text-white mb-1 group-hover:text-red-400 transition-colors">Maven Securities</h3>
                <div class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-4">Numerical Reasoning</div>
                <div class="flex items-center text-xs font-bold text-red-500 uppercase tracking-widest group-hover:translate-x-2 transition-transform">
                    Start Test <i class="bi bi-arrow-right ml-2"></i>
                </div>
            </a>

            <a href="susq_qe_quiz.html" class="firm-card theme-green p-8 rounded-[2rem] group block relative overflow-hidden">
                <div class="absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i class="bi bi-calculator text-9xl text-green-500"></i>
                </div>
                <div class="w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center mb-6 border border-green-500/30 text-green-400">
                    <i class="bi bi-calculator text-xl"></i>
                </div>
                <h3 class="text-2xl font-black text-white mb-1 group-hover:text-green-400 transition-colors">Susquehanna QE</h3>
                <div class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-4">Quant Estimations</div>
                <div class="flex items-center text-xs font-bold text-green-500 uppercase tracking-widest group-hover:translate-x-2 transition-transform">
                    Start Test <i class="bi bi-arrow-right ml-2"></i>
                </div>
            </a>

            <a href="susq_psa_quiz.html" class="firm-card theme-orange p-8 rounded-[2rem] group block relative overflow-hidden">
                <div class="absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity">
                    <i class="bi bi-puzzle text-9xl text-orange-500"></i>
                </div>
                <div class="w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center mb-6 border border-orange-500/30 text-orange-400">
                    <i class="bi bi-puzzle text-xl"></i>
                </div>
                <h3 class="text-2xl font-black text-white mb-1 group-hover:text-orange-400 transition-colors">Susquehanna PSA</h3>
                <div class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-4">Problem Solving</div>
                <div class="flex items-center text-xs font-bold text-orange-500 uppercase tracking-widest group-hover:translate-x-2 transition-transform">
                    Start Test <i class="bi bi-arrow-right ml-2"></i>
                </div>
            </a>

        </div>
    </div>


    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('../sw.js')
                    .then(reg => console.log('SW registered!', reg.scope))
                    .catch(err => console.log('SW failed:', err));
            });
        }
    </script>
    
</body>
</html>